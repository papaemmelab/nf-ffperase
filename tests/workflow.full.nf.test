nextflow_pipeline {

    name "Test Classify Step"
    script "main.nf"
    autoSort false

    test("Should full pipeline: Preprocess + Classify") {
        then {
            with(workflow) {
                // 7: SPLIT_PILEUP + PILEUP + MERGE_PILEUP + COPY_PICARD + ANNOTATE_VARIANTS + CLASSIFY_RANDOM_FOREST + PLOT_REPORT
                assert success
                assert exitStatus == 0
                assert trace.tasks().size() == 7
                assert trace.succeeded().size() == 7
            }
        }
    }

}